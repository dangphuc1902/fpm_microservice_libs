syntax = "proto3";

package com.fpm2025.userauth;

option java_package = "com.fpm2025.userauth";
option java_outer_classname = "UserAuthProto";
option java_multiple_files = true;

message User {
  string user_id = 1;
  string username = 2;
  string email = 3;
  repeated string roles = 4;
}

message LoginRequest {
  string google_token = 1;
}

message LoginResponse {
  string jwt = 1;
  User user = 2;
  int64 expires_in = 3;
}

message TokenRequest {
  string jwt = 1;
}

message TokenResponse {
  bool valid = 1;
  User user = 2;
}

message LogoutRequest {
  string user_id = 1;
}

message LogoutResponse {
  bool success = 1;
}

service AuthService {
  rpc LoginWithGoogle (LoginRequest) returns (LoginResponse);
  rpc ValidateToken (TokenRequest) returns (TokenResponse);
  rpc Logout (LogoutRequest) returns (LogoutResponse);
}