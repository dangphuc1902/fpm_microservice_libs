syntax = "proto3";

package fpm2025.user;

import "common.proto";

option java_multiple_files = true;
option java_package = "com.fpm2025.protocol.user";

service UserGrpcService {
  rpc GetUserById(UserIdRequest) returns (UserResponse);
  rpc GetUsersByIds(UserIdsRequest) returns (UsersResponse);
  rpc ValidateToken(TokenRequest) returns (TokenValidationResponse);
  rpc GetFamilyMembers(FamilyIdRequest) returns (FamilyMembersResponse);
  rpc CheckUserExists(UserIdRequest) returns (UserExistsResponse);
}

message UserIdRequest {
  int64 user_id = 1;
}

message UserIdsRequest {
  repeated int64 user_ids = 1;
}

message TokenRequest {
  string token = 1;
}

message FamilyIdRequest {
  int64 family_id = 1;
}

message UserResponse {
  int64 id = 1;
  string email = 2;
  string full_name = 3;
  string avatar_url = 4;
  string phone = 5;
  string role = 6;
  bool is_active = 7;
  string created_at = 8;
}

message UsersResponse {
  repeated UserResponse users = 1;
}

message TokenValidationResponse {
  bool valid = 1;
  int64 user_id = 2;
  string email = 3;
  string message = 4;
}

message FamilyMember {
  int64 user_id = 1;
  string full_name = 2;
  string avatar_url = 3;
  string role = 4;
  string joined_at = 5;
}

message FamilyMembersResponse {
  int64 family_id = 1;
  string family_name = 2;
  repeated FamilyMember members = 3;
}

message UserExistsResponse {
  bool exists = 1;
}