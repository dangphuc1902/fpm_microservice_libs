syntax = "proto3";

package fpm2025.sharing;

import "common.proto";

option java_multiple_files = true;
option java_package = "com.fpm2025.protocol.sharing";

service SharingGrpcService {
  rpc GetFamilyById(FamilyIdRequest) returns (FamilyResponse);
  rpc GetUserFamilies(UserIdRequest) returns (FamiliesResponse);
  rpc CheckFamilyMembership(MembershipRequest) returns (MembershipResponse);
  rpc GetSharedWallets(FamilyIdRequest) returns (SharedWalletsResponse);
}

message FamilyIdRequest {
  int64 family_id = 1;
}

message UserIdRequest {
  int64 user_id = 1;
}

message MembershipRequest {
  int64 user_id = 1;
  int64 family_id = 2;
}

message FamilyResponse {
  int64 id = 1;
  string name = 2;
  int64 owner_user_id = 3;
  int32 member_count = 4;
  string created_at = 5;
}

message FamiliesResponse {
  repeated FamilyResponse families = 1;
}

message MembershipResponse {
  bool is_member = 1;
  string role = 2; // OWNER, ADMIN, MEMBER, VIEWER
}

message SharedWallet {
  int64 wallet_id = 1;
  string wallet_name = 2;
  fpm2025.common.Money balance = 3;
}

message SharedWalletsResponse {
  repeated SharedWallet wallets = 1;
}